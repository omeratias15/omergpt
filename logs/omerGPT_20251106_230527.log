2025-11-06 23:05:27,474 [INFO] omerGPT.orchestrator: âœ… OmerGPT orchestrator initialized
2025-11-06 23:05:27,475 [INFO] omerGPT.orchestrator: ðŸš€ Starting OmerGPT orchestrator...
2025-11-06 23:05:27,475 [INFO] omerGPT.orchestrator: ðŸ”§ Initializing modules...
2025-11-06 23:05:27,492 [INFO] omerGPT.storage.db_manager: âœ“ Connected to DuckDB: data/market_data.duckdb
2025-11-06 23:05:27,495 [INFO] omerGPT.storage.db_manager: âœ“ All tables and indexes initialized
2025-11-06 23:05:27,500 [INFO] omerGPT.storage.db_manager: âœ“ Meta table initialized
2025-11-06 23:05:27,500 [WARNING] omerGPT.storage.db_manager: âš ï¸ Optimization warning: Parser Error: Unknown unit for memory_limit: '' (expected: KB, MB, GB, TB for 1000^i units or KiB, MiB, GiB, TiB for 1024^i units)
2025-11-06 23:05:27,500 [INFO] omerGPT.storage.db_manager: âœ“ DatabaseManager initialized: data/market_data.duckdb
2025-11-06 23:05:27,500 [INFO] omerGPT.orchestrator: âœ“ Database initialized: data/market_data.duckdb
2025-11-06 23:05:27,501 [INFO] omerGPT.ingestion.binance_ws: Initialized BinanceIngestion for 2 symbols: ['BTCUSDT', 'ETHUSDT'] | interval=1m | batch_size=20 | rate_limit=50msg/s | test_mode=False
2025-11-06 23:05:27,502 [INFO] omerGPT.orchestrator: âœ“ Binance ingestion initialized
2025-11-06 23:05:27,502 [INFO] omerGPT.ingestion.kraken_ws: Initialized KrakenIngestion for 1 symbols | interval=1 | batch_size=20 | rate_limit=50msg/s | test_mode=False
2025-11-06 23:05:27,503 [INFO] omerGPT.ingestion.kraken_ws: Initialized KrakenIngestion for 2 pairs: ['BTC/USDT', 'ETH/USDT'] | channels=['ohlc', 'trade', 'ticker'] | ohlc_interval=1m | batch_size=20 | rate_limit=50msg/s | test_mode=False
2025-11-06 23:05:27,503 [INFO] omerGPT.orchestrator: âœ“ Kraken ingestion initialized
2025-11-06 23:05:27,503 [INFO] omerGPT.ingestion.etherscan_poll: {"ts": "2025-11-06T21:05:27.503969", "event": "init", "msg": "Initialized EtherscanPoller for 0 addresses"}
2025-11-06 23:05:27,504 [INFO] omerGPT.orchestrator: âœ“ Etherscan poller initialized
2025-11-06 23:05:27,504 [INFO] omerGPT.orchestrator: âœ“ CoinGecko poller initialized
2025-11-06 23:05:27,514 [ERROR] omerGPT.sentiment.reddit: Failed to create table: Binder Error: Could not choose a best candidate function for the function call "strftime(STRING_LITERAL, STRING_LITERAL)". In order to select one, please add explicit type casts.
	Candidate functions:
	strftime(TIMESTAMP, VARCHAR) -> VARCHAR
	strftime(TIMESTAMP_NS, VARCHAR) -> VARCHAR
	strftime(VARCHAR, DATE) -> VARCHAR
	strftime(VARCHAR, TIMESTAMP) -> VARCHAR
	strftime(VARCHAR, TIMESTAMP_NS) -> VARCHAR
	strftime(TIMESTAMP WITH TIME ZONE, VARCHAR) -> VARCHAR
	strftime(DATE, VARCHAR) -> VARCHAR


LINE 9:                     retrieved_ts BIGINT DEFAULT CAST(strftime('%s', 'now') AS BIGINT),
                                                             ^
Traceback (most recent call last):
  File "C:\LLM\omerGPT\src\sentiment_analysis\reddit_fetcher.py", line 61, in _create_table
    self.conn.execute("""
duckdb.duckdb.BinderException: Binder Error: Could not choose a best candidate function for the function call "strftime(STRING_LITERAL, STRING_LITERAL)". In order to select one, please add explicit type casts.
	Candidate functions:
	strftime(TIMESTAMP, VARCHAR) -> VARCHAR
	strftime(TIMESTAMP_NS, VARCHAR) -> VARCHAR
	strftime(VARCHAR, DATE) -> VARCHAR
	strftime(VARCHAR, TIMESTAMP) -> VARCHAR
	strftime(VARCHAR, TIMESTAMP_NS) -> VARCHAR
	strftime(TIMESTAMP WITH TIME ZONE, VARCHAR) -> VARCHAR
	strftime(DATE, VARCHAR) -> VARCHAR


LINE 9:                     retrieved_ts BIGINT DEFAULT CAST(strftime('%s', 'now') AS BIGINT),
                                                             ^
2025-11-06 23:05:27,515 [ERROR] omerGPT.orchestrator: âŒ Initialization failed: Binder Error: Could not choose a best candidate function for the function call "strftime(STRING_LITERAL, STRING_LITERAL)". In order to select one, please add explicit type casts.
	Candidate functions:
	strftime(TIMESTAMP, VARCHAR) -> VARCHAR
	strftime(TIMESTAMP_NS, VARCHAR) -> VARCHAR
	strftime(VARCHAR, DATE) -> VARCHAR
	strftime(VARCHAR, TIMESTAMP) -> VARCHAR
	strftime(VARCHAR, TIMESTAMP_NS) -> VARCHAR
	strftime(TIMESTAMP WITH TIME ZONE, VARCHAR) -> VARCHAR
	strftime(DATE, VARCHAR) -> VARCHAR


LINE 9:                     retrieved_ts BIGINT DEFAULT CAST(strftime('%s', 'now') AS BIGINT),
                                                             ^
Traceback (most recent call last):
  File "C:\LLM\omerGPT\src\omerGPT.py", line 175, in initialize
    self.reddit_ingest = RedditFetcher("data/sentiment_data.duckdb")
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\LLM\omerGPT\src\sentiment_analysis\reddit_fetcher.py", line 54, in __init__
    self._create_table()
  File "C:\LLM\omerGPT\src\sentiment_analysis\reddit_fetcher.py", line 61, in _create_table
    self.conn.execute("""
duckdb.duckdb.BinderException: Binder Error: Could not choose a best candidate function for the function call "strftime(STRING_LITERAL, STRING_LITERAL)". In order to select one, please add explicit type casts.
	Candidate functions:
	strftime(TIMESTAMP, VARCHAR) -> VARCHAR
	strftime(TIMESTAMP_NS, VARCHAR) -> VARCHAR
	strftime(VARCHAR, DATE) -> VARCHAR
	strftime(VARCHAR, TIMESTAMP) -> VARCHAR
	strftime(VARCHAR, TIMESTAMP_NS) -> VARCHAR
	strftime(TIMESTAMP WITH TIME ZONE, VARCHAR) -> VARCHAR
	strftime(DATE, VARCHAR) -> VARCHAR


LINE 9:                     retrieved_ts BIGINT DEFAULT CAST(strftime('%s', 'now') AS BIGINT),
                                                             ^
2025-11-06 23:05:27,516 [ERROR] omerGPT.orchestrator: âŒ Orchestrator error: Binder Error: Could not choose a best candidate function for the function call "strftime(STRING_LITERAL, STRING_LITERAL)". In order to select one, please add explicit type casts.
	Candidate functions:
	strftime(TIMESTAMP, VARCHAR) -> VARCHAR
	strftime(TIMESTAMP_NS, VARCHAR) -> VARCHAR
	strftime(VARCHAR, DATE) -> VARCHAR
	strftime(VARCHAR, TIMESTAMP) -> VARCHAR
	strftime(VARCHAR, TIMESTAMP_NS) -> VARCHAR
	strftime(TIMESTAMP WITH TIME ZONE, VARCHAR) -> VARCHAR
	strftime(DATE, VARCHAR) -> VARCHAR


LINE 9:                     retrieved_ts BIGINT DEFAULT CAST(strftime('%s', 'now') AS BIGINT),
                                                             ^
Traceback (most recent call last):
  File "C:\LLM\omerGPT\src\omerGPT.py", line 441, in run
    await self.initialize()
  File "C:\LLM\omerGPT\src\omerGPT.py", line 175, in initialize
    self.reddit_ingest = RedditFetcher("data/sentiment_data.duckdb")
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\LLM\omerGPT\src\sentiment_analysis\reddit_fetcher.py", line 54, in __init__
    self._create_table()
  File "C:\LLM\omerGPT\src\sentiment_analysis\reddit_fetcher.py", line 61, in _create_table
    self.conn.execute("""
duckdb.duckdb.BinderException: Binder Error: Could not choose a best candidate function for the function call "strftime(STRING_LITERAL, STRING_LITERAL)". In order to select one, please add explicit type casts.
	Candidate functions:
	strftime(TIMESTAMP, VARCHAR) -> VARCHAR
	strftime(TIMESTAMP_NS, VARCHAR) -> VARCHAR
	strftime(VARCHAR, DATE) -> VARCHAR
	strftime(VARCHAR, TIMESTAMP) -> VARCHAR
	strftime(VARCHAR, TIMESTAMP_NS) -> VARCHAR
	strftime(TIMESTAMP WITH TIME ZONE, VARCHAR) -> VARCHAR
	strftime(DATE, VARCHAR) -> VARCHAR


LINE 9:                     retrieved_ts BIGINT DEFAULT CAST(strftime('%s', 'now') AS BIGINT),
                                                             ^
2025-11-06 23:05:27,517 [INFO] omerGPT.orchestrator: ðŸ›‘ Initiating graceful shutdown...
2025-11-06 23:05:27,517 [INFO] omerGPT.ingestion.binance_ws: Stopping Binance WebSocket ingestion...
2025-11-06 23:05:27,518 [INFO] omerGPT.ingestion.binance_ws: WebSocket closed | Stats: {'running': False, 'connection_alive': False, 'messages_processed': 0, 'messages_dropped': 0, 'total_candles_written': 0, 'queue_size': 0, 'uptime_seconds': 0}
2025-11-06 23:05:27,518 [INFO] omerGPT.ingestion.kraken_ws: Stopping Kraken WebSocket ingestion...
2025-11-06 23:05:27,518 [INFO] omerGPT.ingestion.kraken_ws: WebSocket closed | Stats: {
  "running": false,
  "connection_alive": false,
  "messages_processed": 0,
  "messages_dropped": 0,
  "total_records_written": 0,
  "ohlc_buffer_size": 0,
  "trade_buffer_size": 0,
  "ticker_buffer_size": 0,
  "subscribed_channels": [],
  "uptime_seconds": 0
}
2025-11-06 23:05:27,518 [ERROR] omerGPT.orchestrator: Error during shutdown: 'EtherscanPoller' object has no attribute 'stop'
Traceback (most recent call last):
  File "C:\LLM\omerGPT\src\omerGPT.py", line 487, in shutdown
    await self.etherscan_poller.stop()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'EtherscanPoller' object has no attribute 'stop'
